# Comfortable-Gakujo
![version](https://img.shields.io/badge/version-1.9.1-green)

## 注意事項
- 非公式の拡張機能です。
- 生成AIによって生成されたソースコードが利用されています。
- この拡張機能は機能5, 6, 8の実現のため、Cookieの機能を使用します。なお、機能を利用しない限り、Cookieは使用されません。
- この拡張機能は機能11の実現のため、ローカルストレージの機能を使用します。なお、機能を利用しない限り、ローカルストレージは使用されません。
- 学情の画面構成などが変更されることで正常に動作しなくなるおそれがあります。
- 無責任、無保証です。利用によって、いかなる問題が発生しても責任を負いません。

## インストール
### 1. ブラウザにTampermonkeyをインストールする
> [!WARNING]
> Chrome系ブラウザでTampermonkey拡張機能（バージョン5.3+）を使用する場合、「ユーザースクリプトを許可」トグル（Chrome 138+では拡張機能の設定から利用可能）または開発者モードのいずれかを有効にする必要があります。（ https://www.tampermonkey.net/faq.php#Q209 ）  
> Microsoft Edgeにおいては、「拡張機能」より、「開発者モード」を有効化し、Tampermonkeyの「詳細」から「ユーザースクリプトを許可する」を有効化する必要があります。
- chrome ウェブストア  
https://chromewebstore.google.com/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo?hl=ja  
- Firefox Browser ADD-ONS  
https://addons.mozilla.org/ja/firefox/addon/tampermonkey/
- Microsoft Edge Addons
https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd?hl=ja-JP

### 2. ブラウザで次のリンクにアクセスし、画面の指示に従って操作する
https://github.com/woody-1227/Comfortable-Gakujo/raw/main/src/Comfortable_Gakujo.user.js

### 3. アップデートについて
Tampermonkeyの自動アップデートを利用できます。  
ただし、自動アップデートを信頼しすぎないでください。  
定期的な手動アップデートをおすすめします。  
  
手動でアップデートを行うには、下記のリンクに再度アクセスしてください。  
https://github.com/woody-1227/Comfortable-Gakujo/raw/main/src/Comfortable_Gakujo.user.js

## 機能
- 1~4, 10の機能は「課題・アンケートリスト」のページにて自動実行されます。
- 10の機能は「課題・アンケート詳細」のページにて自動実行されます。
- 5の機能は「課題・アンケートリスト」のページにて利用可能です。
- 6, 8の機能は「ホーム画面（学生・保護者）」のページにて自動実行されます。
- 11の機能は「ホーム画面（学生・保護者）」のページにて利用可能です。
- 12の機能は「成績情報」のページにて自動実行されます。
- 7の機能はシングルサインオンの同意画面にて自動実行されます。
- 9の機能は学情の全ページにて自動実行されます。
- 8の機能は「ホーム画面（学生・保護者）」のページにてON/OFFを切り替えることができます。
- 5, 6, 8の機能はCookieを使用しますが、これらの機能を利用しない限りCookieは使用されません。
- 11の機能はローカルストレージを使用しますが、この機能を利用しない限りローカルストレージは使用されません。

### 機能一覧
1. 自動並び替え機能
2. 締め切り日時 強調表示
3. カウントダウン表示
4. 提出済み課題 背景色変更
5. 課題 非表示機能
6. 未提出課題の件数 補正機能
7. シングルサインオンの同意画面 自動同意機能
8. 成績更新通知機能
9. サイドバー
10. 課題提出取り消し時 課題詳細への自動遷移機能
11. ホーム画面 ヘッダー画像カスタマイズ機能
12. 成績情報 年度・学期フィルター機能

### <ins>1. 自動並び替え機能 [ver1.1.0-]</ins>
提出期間の締め切り日時順で自動並び替えされます。  
表示件数は自動でallとなります。  

__並び替えは表示されている項目のみを対象に行われます。__   
__表示件数を変更したときのその項目の区切りは通常の表示順（提出期間の開始日時順）となります。__

### <ins>2. 締め切り日時 強調表示 [ver1.1.0-]</ins>
提出期間の締め切り時刻が午前中(00:00~11:59)である場合に、赤太字で強調表示します。

### <ins>3. カウントダウン表示 [ver1.1.0-]</ins>
提出期間の締め切り日時までのカウントダウンを表示します。 
- 残り日数が3日を切っている場合はオレンジ太字
- 残り日数が1日を切っている場合は赤太字(下線付き)
- 締め切り日時超過後は「締切済み」と表示

__カウントダウンは、初めて表示してから1秒おきに更新を行っているため、実際と±1秒程度の誤差がある場合があります。__

### <ins>4. 提出済み課題 背景色変更 [ver1.2.0-]</ins>
提出済みである課題の列全体の背景色を黄緑色に変更します。

### <ins>5. 課題 非表示機能 [ver1.3.0-]</ins>
課題・アンケートリストから特定の課題を非表示にすることができます。  
~~課題自体の存在を消すことはできません。~~  
- 「課題・アンケートリスト」の課題の左側にある「-」ボタンから課題を非表示にすることができます。  
非表示にした課題は、課題リストの下にある「非表示にした課題・アンケート」から確認できます。  
なお、非表示にした課題の情報は、Cookieに保存されます。
- 「非表示にした課題・アンケート」の課題の左側にある「+」ボタンから課題の非表示を解除することができます。

> [!WARNING]
> 非表示機能は、「ホーム画面（学生・保護者）」の未提出課題リストには対応していません。

### <ins>6. 未提出課題の件数 補正機能 [ver1.3.0-]</ins>
「課題 非表示機能」の非表示状態に対応し、「ホーム画面（学生・保護者）」のページにある未提出課題の件数を補正します。  
提出期間内の未提出課題のうち、非表示にされていない課題の件数を赤文字、非表示にされている課題の件数を灰文字で表示します。  

### <ins>7. シングルサインオンの同意画面 自動同意機能 [ver1.4.0-]</ins>
シングルサインオンの確認画面にて、自動で同意ボタンを押下します。 
送信属性はデフォルト値が選択されます。  
「ウェブログインサービス - 過去のリクエスト」画面が表示された場合は、ログイン処理を自動で再試行します。

### <ins>8. 成績更新通知機能 [ver1.5.0-]</ins>
> [!NOTE]
> この機能は成績情報を扱うため、デフォルトでOFFとなっています。  
> 「ホーム画面（学生・保護者）」の画面右上より機能のON/OFFを切り替えることができます。   

「成績ダッシュボード」のデータが更新された場合に「ホーム画面（学生・保護者）」に通知を表示します。  
通知は、「成績ダッシュボード」または「成績情報」にアクセスすると消去されます。  
機能の実現のため、「成績ダッシュボード」のグラフより取得できる 秀・優・良・可・不可の単位数をCookieに保存します。  
情報はハッシュ化され、ブラウザ内にのみ保存されます。

### <ins>9. サイドバー [ver1.6.0-]</ins>
学情の全ページにおいて、サイドバーを追加します。  
サイドバーからは、「シラバス」、「授業情報」、「課題提出」、「履修登録」、「成績」、「単位情報」に遷移できます。  
なお、画面幅が一定値未満の場合（スマートフォンなど）はサイドバーは表示されません。

### <ins>10. 課題提出取り消し時 課題詳細への自動遷移機能 [ver1.7.0-]</ins>
学情では課題提出取り消しを行うと「課題・アンケートリスト」に遷移しますが、元の課題詳細画面に自動遷移するようにします。

### <ins>11. ホーム画面 ヘッダー画像カスタマイズ機能 [ver1.8.0-]</ins>
「ホーム画面（学生・保護者）」のヘッダー画像をカスタマイズできます。  
ヘッダー右上の鉛筆マークをクリックすることで、ヘッダー画像を変更できます。  
画像はクリップ後にローカルストレージにbase64形式で保存されます。  
ヘッダー右上のバツマークをクリックすることで、ヘッダー画像をデフォルトに戻すことができます。

### <ins>12. 成績情報 年度・学期フィルター機能 [ver1.9.0-]</ins>
「成績情報」に年度・学期フィルターを追加します。  
デフォルトでは、8月\~翌年1月は前期、2月\~7月は後期が選択された状態でフィルターが適用されます。  

## 更新履歴
### 2025/07/04 ver1.1.0  
- 「1. 自動並び替え機能」、「2. 締め切り日時 強調表示」、「3. カウントダウン表示」を追加
### 2025/07/06 ver1.1.1
- 「3. カウントダウン表示」におけるカウントダウンの装飾条件を変更
### 2025/07/06 ver1.2.0
- 「4. 提出済み課題 背景色変更」を追加
### 2025/07/07 ver1.2.1
- ver1.1.1と同様、「3. カウントダウン表示」におけるカウントダウンの装飾条件の修正（ver1.2.0にて条件が戻ってしまっていたため）
### 2025/07/31 ver1.3.0
- 「5. 課題 非表示機能」、「6. 未提出課題の件数 補正機能」を追加
- 軽微な修正を実施
### 2026/01/30 ver1.4.0
- 「7. シングルサインオンの同意画面 自動同意機能」を追加
### 2026/02/01 ver1.5.0
- 「8. 成績更新通知機能」を追加
- 軽微な修正を実施
### 2026/02/02 ver1.5.1
- 「7. シングルサインオンの同意画面 自動同意機能」において、「ウェブログインサービス - 過去のリクエスト」画面が表示された場合にログイン処理を自動で再試行する機能を追加
- Chromeでの初回アクセス時やFirefoxでのアクセス時において、ページ表示安定前にUI操作が発生し、UIが表示されない問題を修正（ページ表示安定後にUI操作を行うよう修正）
- UI等の軽微な修正を実施
### 2026/02/02 ver1.5.2
- 「8. 成績更新通知機能」において、成績更新直後に通知が2個表示されてしまう不具合を修正
### 2026/02/02 ver1.5.3
- 「ホーム画面（学生・保護者）」に、Comfortable Gakujoのバージョン情報を表示するようにした
### 2026/02/02 ver1.5.4
- 不要なソースコードを削除
### 2026/02/03 ver1.6.0
- 「9. サイドバー」を追加
### 2026/02/03 ver1.6.1
- 「9. サイドバー」において、「単位情報」へのリンクを追加
### 2026/02/03 ver1.6.2
- 「ホーム画面（学生・保護者）」に表示されるComfortable Gakujoのバージョン情報をクリックすることで、アップデートページに遷移するようにした
### 2026/02/04 ver1.7.0
- 「10. 課題提出取り消し時 課題詳細への自動遷移機能」を追加
### 2026/02/04 ver1.8.0
- 「11. ホーム画面 ヘッダー画像カスタマイズ機能」を追加
### 2026/02/04 ver1.8.1
- 「11. ホーム画面 ヘッダー画像カスタマイズ機能」において、同一ファイルを連続して選択すると画像が更新されない不具合を修正
### 2026/02/06 ver.1.9.0
- 「12. 成績情報 年度・学期フィルター機能」を追加
- 「8. 成績更新通知機能」において、通知ボタンのリンク先を「成績ダッシュボード」から「成績情報」に変更
### 2026/02/07 ver.1.9.1
- 「8. 成績更新通知機能」において、平均GPAが変化しただけで成績情報更新通知が行われてしまう問題を修正（年間GPAおよび平均GPAが誤って保存されていたため修正）
  なお今回の変更によって、保存される成績データの内容が変化するため、アップデート直後に1度だけ誤った「成績更新通知」が表示されます。ご了承ください。
